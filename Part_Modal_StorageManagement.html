<!-- Storage Management Modal -->
<div id="storageManagementModal" class="hidden fixed inset-0 bg-gray-900 bg-opacity-75 flex items-center justify-center z-[80]">
    <div class="bg-white w-11/12 md:max-w-5xl mx-auto rounded-xl shadow-lg z-50 overflow-hidden flex flex-col h-[85vh] animate-bounce-in">
        
        <!-- Header -->
        <div class="bg-gradient-to-r from-orange-500 to-red-500 px-4 py-3 flex justify-between items-center shrink-0">
            <h3 class="font-bold text-lg text-white flex items-center gap-2">
                <i class="fa-solid fa-boxes-packing"></i> จัดการฝากของ
            </h3>
            <div class="flex items-center gap-2">
                 <!-- Add Storage Button -->
                 <button onclick="openStorageModal(null, '', '')" class="bg-white text-orange-600 hover:bg-orange-50 font-bold py-1.5 px-3 rounded-lg text-xs shadow-sm transition flex items-center gap-1">
                    <i class="fa-solid fa-plus-circle"></i> ฝากของใหม่
                 </button>
                 <button onclick="closeStorageManagementModal()" class="text-white hover:text-orange-200 transition ml-2">
                    <i class="fa-solid fa-times text-lg"></i>
                </button>
            </div>
        </div>

        <!-- Toolbar -->
        <div class="bg-gray-50 px-4 py-3 border-b border-gray-200 flex flex-col md:flex-row gap-3 justify-between items-center">
            <div class="flex gap-2 w-full md:w-auto">
                <div class="relative w-full md:w-64">
                    <input type="text" id="store_searchInput" onkeyup="filterStorageList()" placeholder="ค้นหา (ล็อค, ชื่อ, โทร)..." class="w-full pl-8 pr-3 py-1.5 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-orange-400">
                    <i class="fa-solid fa-search absolute left-2.5 top-2.5 text-gray-400 text-xs"></i>
                </div>
                <select id="store_filterStatus" onchange="filterStorageList()" class="border border-gray-300 rounded-lg px-2 py-1.5 text-sm focus:outline-none focus:ring-2 focus:ring-orange-400 bg-white">
                    <option value="Active">กำลังฝาก (Active)</option>
                    <option value="Completed">คืนแล้ว (History)</option>
                    <option value="All">ทั้งหมด</option>
                </select>
            </div>
            <button onclick="fetchStorageList()" class="text-gray-500 hover:text-orange-600 transition text-sm">
                <i class="fa-solid fa-sync-alt mr-1"></i> รีเฟรช
            </button>
        </div>

        <!-- Content Table -->
        <div class="flex-1 overflow-auto p-0 relative bg-white">
            <div id="store_loading" class="hidden absolute inset-0 bg-white bg-opacity-90 z-10 flex flex-col items-center justify-center text-gray-400">
                <i class="fa-solid fa-circle-notch fa-spin text-3xl mb-2 text-orange-500"></i>
                <p class="text-sm">กำลังโหลดข้อมูล...</p>
            </div>

            <table class="w-full text-sm text-left whitespace-nowrap">
                <thead class="bg-gray-100 text-gray-600 font-bold sticky top-0 z-10 shadow-sm">
                    <tr>
                        <th class="px-4 py-3 text-center w-10">#</th>
                        <th class="px-4 py-3">วันที่เริ่ม - สิ้นสุด</th>
                        <th class="px-4 py-3">ล็อค</th>
                        <th class="px-4 py-3">เจ้าของ</th>
                        <th class="px-4 py-3">โน้ต</th>
                        <th class="px-4 py-3 text-center">สถานะ</th>
                        <th class="px-4 py-3 text-center">จัดการ</th>
                    </tr>
                </thead>
                <tbody id="store_tableBody" class="divide-y divide-gray-100">
                    <!-- Rows will be injected here -->
                </tbody>
            </table>
            
            <div id="store_noData" class="hidden flex flex-col items-center justify-center py-12 text-gray-400">
                <i class="fa-solid fa-box-open text-4xl mb-2 opacity-30"></i>
                <p>ไม่พบข้อมูล</p>
            </div>
        </div>

        <!-- Footer -->
        <div class="bg-gray-50 px-4 py-2 border-t border-gray-200 text-xs text-gray-500 flex justify-between items-center">
            <div id="store_countInfo">รายการทั้งหมด: 0</div>
            <button onclick="closeStorageManagementModal()" class="px-4 py-2 bg-white border border-gray-300 rounded hover:bg-gray-100 font-bold text-gray-600">ปิด</button>
        </div>
    </div>
</div>