<style>
    @import url('https://fonts.googleapis.com/css2?family=Mali:wght@300;400;500;600;700&family=Sarabun:wght@400;500;700&display=swap');

    /* ------------------------------------------------------------------
     * VINTAGE THEME STYLES
     * ธีมกระดาษเก่า ดูขลังๆ ตามความต้องการ
     * ------------------------------------------------------------------ */
    
    body { 
        font-family: 'Sarabun', sans-serif; 
        background-color: #FDF5E6; /* Old Lace (สีครีมกระดาษเก่า) */
        background-image: url('https://www.transparenttextures.com/patterns/cream-paper.png');
        color: #4A3B32; /* สีน้ำตาลเข้ม (แทนสีดำล้วน) */
    }

    /* Override Header Style for Vintage Look */
    header {
        background-color: #FAEBD7 !important; /* AntiqueWhite */
        background-image: url('https://www.transparenttextures.com/patterns/cream-paper.png');
        border-bottom: 3px solid #8B4513 !important; /* SaddleBrown */
        box-shadow: 0 4px 6px rgba(62, 39, 35, 0.2) !important;
    }
    
    /* Market Grid: กระดานไม้/กระดาษอัด */
    .market-grid {
        display: grid;
        grid-template-columns: repeat(20, minmax(45px, 1fr));
        min-height: 800px;
        grid-auto-rows: minmax(25px, auto); 
        gap: 3px; 
        overflow-x: auto;
        padding: 12px;
        
        background-color: #D7CCC8; /* สีไม้เบาๆ */
        background-image: url('https://www.transparenttextures.com/patterns/wood-pattern.png');
        border: 4px solid #5D4037; /* กรอบไม้สีเข้ม */
        border-radius: 8px;
        box-shadow: inset 0 0 30px rgba(0,0,0,0.2), 0 10px 20px rgba(0,0,0,0.3);
        position: relative; 
    }
    
    .grid-loading-overlay {
        position: absolute;
        top: 0; left: 0; right: 0; bottom: 0;
        background-color: rgba(253, 245, 230, 0.85); /* Cream overlay */
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 20;
        transition: opacity 0.2s ease-in-out;
        backdrop-filter: blur(2px);
    }

    /* Stall Box: กระดาษโน้ต */
    .stall-box {
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        font-size: 0.85rem;
        transition: all 0.2s ease-in-out;
        
        background-color: #fff;
        border: 1px solid #A1887F;
        border-radius: 2px; /* มุมคมขึ้นเหมือนกระดาษตัด */
        box-shadow: 1px 1px 3px rgba(0,0,0,0.15);
        
        min-height: 25px;
        font-weight: 600; 
        padding-top: 4px; 
        padding-bottom: 2px;
        backface-visibility: hidden;
        transform: translateZ(0);
        -webkit-font-smoothing: subpixel-antialiased;
        color: #3E2723;
    }
    
    .stall-box.clickable { cursor: pointer; }
    .stall-box.clickable:hover { 
        transform: scale(1.15) rotate(-1deg); /* เอียงนิดๆ เหมือนกระดาษแปะ */
        z-index: 20; 
        border: 1px solid #5D4037; 
        box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.3); 
    }
    
    .stall-box.non-clickable { cursor: default; opacity: 0.8; }
    
    /* --- VINTAGE COLOR PALETTE (Paper Style) --- */
    
    /* Food Free: Green Paper */
    .bg-food-free { 
        background-color: #DCEDC8; /* Light Green */
        border-color: #AED581;
        color: #33691E;
    }
    
    /* Cloth Free: Cyan/Blue Paper */
    .bg-cloth-free { 
        background-color: #B3E5FC; /* Light Blue */
        border-color: #81D4FA;
        color: #01579B;
    }
    
    /* Unpaid: Orange Paper (Warning) */
    .bg-food-unpaid, .bg-cloth-unpaid { 
        background-color: #FFE0B2; /* Orange */
        border-color: #FFB74D;
        color: #E65100;
        /* ลายเส้นทแยงมุมจางๆ */
        background-image: repeating-linear-gradient(45deg, transparent, transparent 5px, rgba(255,255,255,0.4) 5px, rgba(255,255,255,0.4) 10px);
    }
    
    /* Occupied: Red/Pink Paper (Sold) */
    .bg-food-occupied, .bg-cloth-occupied { 
        background-color: #FFCDD2; /* Red */
        border-color: #E57373;
        color: #B71C1C;
        font-weight: bold;
    }
    
    /* Monthly: Purple Paper */
    .bg-monthly { 
        background-color: #E1BEE7; /* Purple */
        border-color: #BA68C8;
        color: #4A148C;
    }
    
    /* Walkway: Stone/Concrete Path (Updated) */
    .bg-walkway { 
        background-color: #9E9E9E; /* สีเทาเรียบๆ ดูเป็นทางเดินชัดเจน */
        border: 1px solid #757575;
        pointer-events: none; 
        opacity: 0.8;
    }
    
    /* Other: Yellow Note */
    .bg-other { 
        background-color: #FFF9C4; 
        border: 1px dashed #FBC02D;
        color: #F57F17;
        pointer-events: none; 
    }

    /* Modal Transitions */
    .modal { transition: opacity 0.2s ease-out; } 
    body.modal-active { overflow-x: hidden; overflow-y: hidden !important; }
    
    /* Animation: Fade In */
    @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    .animate-bounce-in { animation: fadeIn 0.2s ease-out; }

    /* Animation: Pop In */
    @keyframes pop-in {
        0% { opacity: 0; transform: scale(0.95); }
        100% { opacity: 1; transform: scale(1); }
    }
    .animate-pop-in { animation: pop-in 0.2s ease-out forwards; }

    /* Animation: Fade In Up Centered */
    @keyframes fade-in-centered {
        0% { opacity: 0; transform: translate(-50%, -40%) scale(0.95); }
        100% { opacity: 1; transform: translate(-50%, -50%) scale(1); }
    }
    .animate-fade-in-centered { animation: fade-in-centered 0.2s ease-out forwards; }

    /* Custom Scrollbar (Vintage Brown) */
    .custom-scrollbar::-webkit-scrollbar { width: 8px; }
    .custom-scrollbar::-webkit-scrollbar-track { background: #F5DEB3; }
    .custom-scrollbar::-webkit-scrollbar-thumb { background: #8B5A2B; border-radius: 4px; }
    .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: #6D4C41; }
    #quick-dates::-webkit-scrollbar { display: none; }
    #quick-dates { -ms-overflow-style: none; scrollbar-width: none; }

    /* Search Highlight Animation */
    @keyframes pulse-ring {
        0% { transform: scale(1); box-shadow: 0 0 0 0 rgba(139, 90, 43, 0.7); }
        50% { transform: scale(1.1); box-shadow: 0 0 0 10px rgba(139, 90, 43, 0); }
        100% { transform: scale(1); box-shadow: 0 0 0 0 rgba(139, 90, 43, 0); }
    }
    
    .search-highlight {
        animation: pulse-ring 1.5s cubic-bezier(0.24, 0, 0.38, 1) infinite;
        z-index: 50 !important;
        border: 2px solid #8B4513 !important; 
        background-color: #FFF8E1 !important;
        position: relative;
    }

    /* ------------------------------------------------------------------
     * PRINT SYSTEM (CONSOLIDATED & FIXED)
     * ------------------------------------------------------------------ */
    @media print {
        body { 
            margin: 0 !important; 
            padding: 0 !important; 
            background-color: white !important;
            overflow: visible !important;
            background-image: none !important;
        }
        body * { visibility: hidden; }

        #ticket-area, #ticket-area *, 
        #monthly-ticket-area, #monthly-ticket-area * {
            visibility: visible !important;
        }

        #report-print-area, #report-print-area * {
            visibility: visible !important;
        }

        #ticket-area, #monthly-ticket-area {
            display: block !important;
            position: absolute !important; 
            left: 0 !important; 
            top: 0 !important; 
            width: 80mm !important; 
            padding: 2mm !important;
            margin: 0 !important; 
            font-family: 'Sarabun', sans-serif !important; 
            color: black !important; 
            background-color: white !important;
            font-size: 12px !important;
            z-index: 99999 !important;
        }

        #report-print-area {
            display: block !important;
            position: absolute !important;
            left: 0 !important;
            top: 0 !important;
            width: 100% !important;
            background-color: white !important;
            z-index: 99999 !important;
        }

        #ticket-area *, #monthly-ticket-area *, #report-print-area * {
            -webkit-print-color-adjust: exact !important;
            print-color-adjust: exact !important;
        }

        header, .modal, .container, #status-legend, .modal-overlay, .grid-loading-overlay, #processOverlay { 
            display: none !important; 
        }

        @page { size: auto; margin: 0; }
    }
</style>