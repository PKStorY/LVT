<!-- Daily Booking Modal -->
<div id="bookingModalDaily" style="display:none;" class="modal opacity-0 pointer-events-none fixed w-full h-full top-0 left-0 flex items-center justify-center z-50">
    <div class="modal-overlay absolute w-full h-full bg-gray-900 opacity-50" onclick="closeModalDaily()"></div>
    <div class="modal-container bg-white w-11/12 md:max-w-md mx-auto rounded-xl shadow-lg z-50 overflow-y-auto max-h-[90vh]">
        
        <!-- Header (Blue Gradient for Daily) -->
        <div class="modal-header bg-gradient-to-r from-blue-600 to-indigo-600 px-4 py-3 rounded-t-xl relative flex flex-col shadow-sm">
            <div class="cursor-pointer absolute right-2 top-2 z-50 text-white opacity-70 hover:opacity-100 transition" onclick="closeModalDaily()">
                <i class="fa-solid fa-circle-xmark text-xl"></i>
            </div>
            
            <div class="flex justify-between items-center pt-1 pr-6"> 
                <div class="flex items-center gap-2 text-white">
                    <i class="fa-solid fa-calendar-day text-lg"></i>
                    <h3 class="font-bold text-sm mt-0.5">การจองล็อค : รายวัน</h3>
                </div>
                <!-- Buttons Area: Storage & Utility (Daily Only) -->
                <div class="flex items-center gap-2">
                    <button type="button" onclick="openUtilityModal()" class="text-white hover:text-yellow-200 transition text-sm" title="เพิ่มค่าไฟ">
                        <i class="fa-solid fa-bolt"></i>
                    </button>
                    <button type="button" id="d_btn_storage" class="text-white hover:text-orange-200 transition text-sm" title="แจ้งฝากของ">
                        <i class="fa-solid fa-box-open"></i>
                    </button>
                </div>
            </div>
            
            <div class="flex justify-between items-center mt-2">
                <div class="text-white text-sm font-medium" id="d_header_date_right"></div>
                <div class="flex items-center gap-2 text-blue-100 text-[10px]">
                    <i class="fa-solid fa-user-tie"></i>
                    <span>เจ้าหน้าที่: <span class="font-bold text-white" id="d_admin_badge"></span></span>
                </div>
            </div>
        </div>

        <div class="modal-content py-4 text-left px-6">
            <form id="bookingFormDaily" onsubmit="submitBookingDailyEvent(event)" class="space-y-3">
                <input type="hidden" id="d_bookingId">
                <input type="hidden" id="d_rentType" value="รายวัน">
                <input type="hidden" id="d_date"> 
                
                <!-- Stalls (Daily) -->
                <div class="bg-blue-50 p-2 rounded-lg border border-blue-100 flex items-center gap-2 relative">
                    <label class="block text-gray-700 text-sm font-bold mr-2 shrink-0">รายการล็อค:</label>
                    <div id="selectedStallsContainer_Daily" class="flex-1 flex flex-nowrap gap-1 overflow-x-auto pr-8 min-h-[32px] items-center"></div>
                    <div class="absolute right-2 top-1/2 transform -translate-y-1/2">
                        <!-- FIX: Call Daily Toggle Function -->
                        <button type="button" id="d_btnAddStall" onclick="toggleAddStallDropdownDaily()" class="w-7 h-7 flex items-center justify-center bg-white border border-blue-300 text-blue-600 rounded-full hover:bg-blue-600 hover:text-white transition shadow-sm text-sm font-bold" title="เพิ่มล็อค"><i class="fa-solid fa-plus pointer-events-none"></i></button>
                    </div>
                </div>

                <!-- Customer Info -->
                <div class="grid grid-cols-2 gap-3">
                    <div><label class="block text-gray-700 text-sm font-bold mb-1">ชื่อผู้จอง</label><input type="text" id="d_bookerName" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-400 bg-white transition text-base" placeholder="ระบุชื่อ-สกุล" required></div>
                    <div><label class="block text-gray-700 text-sm font-bold mb-1">สินค้าที่ขาย</label><input type="text" id="d_product" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-400 bg-white transition text-base" placeholder="ระบุสินค้า" required></div>
                </div>
                <input type="hidden" id="d_phone">

                <!-- Price Section -->
                <div class="grid grid-cols-3 gap-2 items-end bg-gray-50 p-2 rounded-lg border border-gray-200 mt-3">
                    <div>
                        <label class="block text-gray-500 text-[10px] mb-1 text-center">ค่าฝาก (บาท)</label>
                        <div class="relative">
                            <input type="number" id="d_storageFee" value="0" min="0" class="w-full pl-1 pr-1 py-1 border border-gray-300 rounded text-center text-lg font-bold focus:border-blue-500" oninput="calcTotalDaily()">
                        </div>
                    </div>
                    <div>
                        <label class="block text-gray-500 text-[10px] mb-1 text-center">ค่าไฟ (หน่วย)</label>
                        <div class="relative">
                            <input type="number" id="d_elecUnit" value="0" min="0" class="w-full pl-1 pr-1 py-1 border border-gray-300 rounded text-center text-lg font-bold focus:border-blue-500" oninput="calcTotalDaily()">
                        </div>
                    </div>
                    <div>
                        <label class="block text-blue-600 text-[10px] font-bold mb-1 text-center">รวม (บาท)</label>
                        <div class="w-full px-2 py-1 bg-blue-100 border border-blue-200 rounded text-right font-bold text-blue-800 text-lg" id="d_totalPrice">0.00</div>
                    </div>
                </div>

                <!-- Payment Section -->
                <div id="d_paymentSection">
                    <div class="flex items-end gap-3 mt-2">
                        <div class="flex-1">
                            <label class="block text-gray-700 text-sm font-bold mb-1">การชำระเงิน</label>
                            <div class="flex gap-1 h-[42px]">
                                <button type="button" onclick="selectPaymentDaily('Cash')" id="d_btn_cash" class="flex-1 border rounded text-xs font-bold transition-all h-full disabled:opacity-50 disabled:cursor-not-allowed disabled:bg-gray-100" disabled><i class="fa-solid fa-coins mr-1"></i>เงินสด</button>
                                <button type="button" onclick="selectPaymentDaily('Transfer')" id="d_btn_transfer" class="flex-1 border rounded text-xs font-bold transition-all h-full disabled:opacity-50 disabled:cursor-not-allowed disabled:bg-gray-100" disabled><i class="fa-solid fa-mobile-screen mr-1"></i>โอน</button>
                            </div>
                            <input type="hidden" id="d_paymentMethod" value="">
                        </div>
                        <div class="w-1/3">
                            <label class="block text-gray-700 text-sm font-bold mb-1 text-right">รับเงินมา</label>
                            <input type="number" id="d_paidAmount" class="w-full px-2 py-1.5 border border-green-400 rounded text-right font-bold text-green-700 bg-green-50 text-base placeholder-green-300 focus:ring-2 focus:ring-green-400 focus:outline-none h-[42px]" placeholder="0.00" oninput="checkPaymentAmountDaily()">
                        </div>
                    </div>
                </div>

                <div class="mb-2"><label class="text-xs text-gray-500">โน้ตเพิ่มเติม</label><textarea id="d_note" class="w-full p-2 border border-gray-300 rounded text-xs focus:outline-none focus:ring-1 focus:ring-blue-400" rows="2"></textarea></div>
                
                <!-- Buttons -->
                <div class="flex justify-end space-x-2 pt-2 border-t mt-4 items-center">
                    <button type="button" id="d_btn_delete" onclick="deleteCurrentBookingDaily()" class="hidden px-2 py-1.5 bg-gray-100 text-gray-500 rounded hover:bg-red-100 hover:text-red-600 text-xs font-bold transition border border-gray-200"><i class="fa-solid fa-trash mr-1"></i>ลบ</button>
                    <button type="button" id="d_btn_leave" onclick="leaveCurrentBooking()" class="hidden px-2 py-1.5 bg-gray-100 text-gray-500 rounded hover:bg-orange-100 hover:text-orange-600 text-xs font-bold transition border border-gray-200"><i class="fa-solid fa-user-xmark mr-1"></i>ลา</button>
                    <button type="button" id="d_btn_move" onclick="openMoveBookingModal()" class="hidden px-2 py-1.5 bg-gray-100 text-purple-600 rounded hover:bg-purple-100 text-xs font-bold transition border border-gray-200"><i class="fa-solid fa-right-left mr-1"></i>ย้าย</button>
                    
                    <div class="flex-1"></div> 

                    <button type="button" id="d_btn_preview" onclick="openDailyTicketPreview()" class="hidden px-4 py-2 bg-blue-100 text-blue-600 rounded-lg hover:bg-blue-200 text-sm font-bold transition"><i class="fa-solid fa-eye"></i> ดู</button>
                    <button type="button" id="d_btn_print" onclick="printTicket()" class="hidden px-4 py-2 bg-gray-800 text-white rounded-lg hover:bg-black text-sm font-bold transition"><i class="fa-solid fa-print"></i> พิมพ์</button>
                    
                    <button type="submit" class="px-6 py-2.5 bg-gradient-to-r from-blue-600 to-blue-700 text-white rounded-lg hover:from-blue-700 hover:to-blue-800 shadow-md hover:shadow-lg text-sm font-bold transition-all transform active:scale-95"><i class="fa-regular fa-save mr-1"></i> บันทึก</button>
                </div>
            </form>
        </div>
    </div>
</div>